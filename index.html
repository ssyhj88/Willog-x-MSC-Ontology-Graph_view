
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>MSC Ontology Clean View</title>
    <script type="text/javascript" src="https://unpkg.com/vis-network/standalone/umd/vis-network.min.js"></script>
    <style>
        body { margin: 0; padding: 0; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; overflow: hidden; background: #f4f4f4; }
        
        #controls {
            position: absolute; top: 10px; left: 10px; z-index: 100;
            background: rgba(255, 255, 255, 0.95); 
            padding: 15px;
            border-radius: 12px; 
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
            width: 280px;
            max-height: 90vh;
            display: flex;
            flex-direction: column;
            border: 1px solid #e0e0e0;
        }
        
        h3 { margin: 0 0 15px 0; font-size: 18px; color: #2c3e50; border-bottom: 2px solid #3498db; padding-bottom: 8px; }
        h4 { margin: 15px 0 8px 0; font-size: 13px; color: #7f8c8d; text-transform: uppercase; letter-spacing: 1px; font-weight: 600; }
        
        select#nodeSelect {
            width: 100%; padding: 8px; margin-bottom: 5px;
            border: 1px solid #bdc3c7; border-radius: 6px;
            font-size: 14px;
        }

        #selectionInfo {
            padding: 10px; background: #ecf0f1; border-radius: 6px;
            margin-top: 5px; font-size: 13px; color: #2c3e50;
            border-left: 4px solid #3498db; display: none;
        }

        .checkbox-container {
            overflow-y: auto;
            flex-grow: 1;
            max-height: 350px;
            border: 1px solid #ecf0f1;
            padding: 8px;
            background: #fff;
            border-radius: 6px;
            margin-top: 5px;
        }
        
        .checkbox-item {
            display: flex;
            align-items: center;
            padding: 6px 0;
            font-size: 14px;
            cursor: pointer;
            border-bottom: 1px solid #f9f9f9;
        }
        .checkbox-item:hover { background-color: #e8f6f3; }
        .checkbox-item input { margin-right: 10px; transform: scale(1.2); cursor: pointer; accent-color: #3498db; }
        
        .btn-group { display: flex; gap: 10px; margin-top: 15px; }
        button { 
            flex: 1; padding: 10px; border: none; border-radius: 6px; 
            cursor: pointer; font-weight: 600; font-size: 13px;
            transition: all 0.2s;
        }
        .btn-reset { background: #95a5a6; color: white; }
        .btn-reset:hover { background: #7f8c8d; }
        .btn-fit { background: #3498db; color: white; }
        .btn-fit:hover { background: #2980b9; }

        #mynetwork { width: 100vw; height: 100vh; background: #ffffff; }
        
        .legend {
            position: absolute; bottom: 20px; right: 20px; z-index: 90;
            background: rgba(255, 255, 255, 0.9); padding: 15px;
            border: 1px solid #ddd; border-radius: 8px; font-size: 13px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
            line-height: 1.6;
        }
    </style>
</head>
<body>

<div id="controls">
    <h3>Graph Explorer</h3>
    
    <div id="selectionInfo">
        <strong>Selected:</strong> <span id="selectedNodeName">-</span><br>
        <strong>Group:</strong> <span id="selectedNodeGroup">-</span>
    </div>

    <h4>Search Node</h4>
    <select id="nodeSelect" onchange="highlightNode(this.value)">
        <option value="">Select a Node...</option>
        <option value="Actor">Actor</option><option value="BatchLot">BatchLot</option><option value="Container">Container</option><option value="ContractDocument">ContractDocument</option><option value="ControlAction">ControlAction</option><option value="Device">Device</option><option value="DocumentRecord">DocumentRecord</option><option value="Event">Event</option><option value="Facility">Facility</option><option value="Flight">Flight</option><option value="Incident">Incident</option><option value="IncidentPattern">IncidentPattern</option><option value="Lane">Lane</option><option value="Location">Location</option><option value="OperationalDocument">OperationalDocument</option><option value="Organization">Organization</option><option value="Package">Package</option><option value="Product">Product</option><option value="RegulationDocument">RegulationDocument</option><option value="RiskScore">RiskScore</option><option value="Role">Role</option><option value="SLA_KPI">SLA_KPI</option><option value="SOPDocument">SOPDocument</option><option value="Sensor">Sensor</option><option value="SensorReading">SensorReading</option><option value="Shipment">Shipment</option><option value="ShipmentItem">ShipmentItem</option><option value="StabilityBudget">StabilityBudget</option><option value="TempProfile">TempProfile</option><option value="TransportLeg">TransportLeg</option><option value="TruckMovement">TruckMovement</option><option value="Vehicle">Vehicle</option>
    </select>

    <h4>Domain Groups</h4>
    <div class="checkbox-container">
        
        <label class="checkbox-item" id="label-DocumentDomain">
            <input type="checkbox" name="groupFilter" value="DocumentDomain" onchange="updateByGroups()">
            DocumentDomain
        </label>
        <label class="checkbox-item" id="label-EventDomain">
            <input type="checkbox" name="groupFilter" value="EventDomain" onchange="updateByGroups()">
            EventDomain
        </label>
        <label class="checkbox-item" id="label-GovernanceDomain">
            <input type="checkbox" name="groupFilter" value="GovernanceDomain" onchange="updateByGroups()">
            GovernanceDomain
        </label>
        <label class="checkbox-item" id="label-LocationDomain">
            <input type="checkbox" name="groupFilter" value="LocationDomain" onchange="updateByGroups()">
            LocationDomain
        </label>
        <label class="checkbox-item" id="label-OrganizationDomain">
            <input type="checkbox" name="groupFilter" value="OrganizationDomain" onchange="updateByGroups()">
            OrganizationDomain
        </label>
        <label class="checkbox-item" id="label-ProductDomain">
            <input type="checkbox" name="groupFilter" value="ProductDomain" onchange="updateByGroups()">
            ProductDomain
        </label>
        <label class="checkbox-item" id="label-SensorDomain">
            <input type="checkbox" name="groupFilter" value="SensorDomain" onchange="updateByGroups()">
            SensorDomain
        </label>
        <label class="checkbox-item" id="label-ShipmentDomain">
            <input type="checkbox" name="groupFilter" value="ShipmentDomain" onchange="updateByGroups()">
            ShipmentDomain
        </label>
    </div>
    
    <div class="btn-group">
        <button class="btn-reset" onclick="resetAll()">Reset</button>
        <button class="btn-fit" onclick="network.fit()">Fit View</button>
    </div>
</div>

<div id="mynetwork"></div>

<div class="legend">
    <strong>Interaction Guide</strong><br>
    üñ±Ô∏è <b>Click Node</b>: Focus node & neighbors.<br>
    üñ±Ô∏èüñ±Ô∏è <b>Double Click</b>: Select <u>entire group</u>.<br>
    ‚òëÔ∏è <b>Checkboxes</b>: Combine groups.<br>
    <span style="color:#aaa">* Domain nodes are hidden.</span>
</div>

<script type="text/javascript">
    var nodesArray = [{"id": "IncidentPattern", "label": "IncidentPattern", "group": "EventDomain", "title": "Class: IncidentPattern\nGroup: EventDomain (Double click to view group)", "shape": "box", "font": {"color": "black"}}, {"id": "Actor", "label": "Actor", "group": "OrganizationDomain", "title": "Class: Actor\nGroup: OrganizationDomain (Double click to view group)", "shape": "box", "font": {"color": "black"}}, {"id": "TruckMovement", "label": "TruckMovement", "group": "ShipmentDomain", "title": "Class: TruckMovement\nGroup: ShipmentDomain (Double click to view group)", "shape": "box", "font": {"color": "black"}}, {"id": "Device", "label": "Device", "group": "SensorDomain", "title": "Class: Device\nGroup: SensorDomain (Double click to view group)", "shape": "box", "font": {"color": "black"}}, {"id": "Vehicle", "label": "Vehicle", "group": "ShipmentDomain", "title": "Class: Vehicle\nGroup: ShipmentDomain (Double click to view group)", "shape": "box", "font": {"color": "black"}}, {"id": "TempProfile", "label": "TempProfile", "group": "ProductDomain", "title": "Class: TempProfile\nGroup: ProductDomain (Double click to view group)", "shape": "box", "font": {"color": "black"}}, {"id": "Location", "label": "Location", "group": "LocationDomain", "title": "Class: Location\nGroup: LocationDomain (Double click to view group)", "shape": "box", "font": {"color": "black"}}, {"id": "ContractDocument", "label": "ContractDocument", "group": "DocumentDomain", "title": "Class: ContractDocument\nGroup: DocumentDomain (Double click to view group)", "shape": "box", "font": {"color": "black"}}, {"id": "SensorReading", "label": "SensorReading", "group": "SensorDomain", "title": "Class: SensorReading\nGroup: SensorDomain (Double click to view group)", "shape": "box", "font": {"color": "black"}}, {"id": "TransportLeg", "label": "TransportLeg", "group": "ShipmentDomain", "title": "Class: TransportLeg\nGroup: ShipmentDomain (Double click to view group)", "shape": "box", "font": {"color": "black"}}, {"id": "Organization", "label": "Organization", "group": "OrganizationDomain", "title": "Class: Organization\nGroup: OrganizationDomain (Double click to view group)", "shape": "box", "font": {"color": "black"}}, {"id": "Event", "label": "Event", "group": "EventDomain", "title": "Class: Event\nGroup: EventDomain (Double click to view group)", "shape": "box", "font": {"color": "black"}}, {"id": "SOPDocument", "label": "SOPDocument", "group": "DocumentDomain", "title": "Class: SOPDocument\nGroup: DocumentDomain (Double click to view group)", "shape": "box", "font": {"color": "black"}}, {"id": "Role", "label": "Role", "group": "OrganizationDomain", "title": "Class: Role\nGroup: OrganizationDomain (Double click to view group)", "shape": "box", "font": {"color": "black"}}, {"id": "Flight", "label": "Flight", "group": "ShipmentDomain", "title": "Class: Flight\nGroup: ShipmentDomain (Double click to view group)", "shape": "box", "font": {"color": "black"}}, {"id": "StabilityBudget", "label": "StabilityBudget", "group": "ProductDomain", "title": "Class: StabilityBudget\nGroup: ProductDomain (Double click to view group)", "shape": "box", "font": {"color": "black"}}, {"id": "RiskScore", "label": "RiskScore", "group": "GovernanceDomain", "title": "Class: RiskScore\nGroup: GovernanceDomain (Double click to view group)", "shape": "box", "font": {"color": "black"}}, {"id": "OperationalDocument", "label": "OperationalDocument", "group": "DocumentDomain", "title": "Class: OperationalDocument\nGroup: DocumentDomain (Double click to view group)", "shape": "box", "font": {"color": "black"}}, {"id": "Container", "label": "Container", "group": "ShipmentDomain", "title": "Class: Container\nGroup: ShipmentDomain (Double click to view group)", "shape": "box", "font": {"color": "black"}}, {"id": "Package", "label": "Package", "group": "ShipmentDomain", "title": "Class: Package\nGroup: ShipmentDomain (Double click to view group)", "shape": "box", "font": {"color": "black"}}, {"id": "Shipment", "label": "Shipment", "group": "ShipmentDomain", "title": "Class: Shipment\nGroup: ShipmentDomain (Double click to view group)", "shape": "box", "font": {"color": "black"}}, {"id": "DocumentRecord", "label": "DocumentRecord", "group": "DocumentDomain", "title": "Class: DocumentRecord\nGroup: DocumentDomain (Double click to view group)", "shape": "box", "font": {"color": "black"}}, {"id": "Incident", "label": "Incident", "group": "EventDomain", "title": "Class: Incident\nGroup: EventDomain (Double click to view group)", "shape": "box", "font": {"color": "black"}}, {"id": "RegulationDocument", "label": "RegulationDocument", "group": "DocumentDomain", "title": "Class: RegulationDocument\nGroup: DocumentDomain (Double click to view group)", "shape": "box", "font": {"color": "black"}}, {"id": "BatchLot", "label": "BatchLot", "group": "ProductDomain", "title": "Class: BatchLot\nGroup: ProductDomain (Double click to view group)", "shape": "box", "font": {"color": "black"}}, {"id": "Product", "label": "Product", "group": "ProductDomain", "title": "Class: Product\nGroup: ProductDomain (Double click to view group)", "shape": "box", "font": {"color": "black"}}, {"id": "Facility", "label": "Facility", "group": "LocationDomain", "title": "Class: Facility\nGroup: LocationDomain (Double click to view group)", "shape": "box", "font": {"color": "black"}}, {"id": "Lane", "label": "Lane", "group": "LocationDomain", "title": "Class: Lane\nGroup: LocationDomain (Double click to view group)", "shape": "box", "font": {"color": "black"}}, {"id": "Sensor", "label": "Sensor", "group": "SensorDomain", "title": "Class: Sensor\nGroup: SensorDomain (Double click to view group)", "shape": "box", "font": {"color": "black"}}, {"id": "ShipmentItem", "label": "ShipmentItem", "group": "ShipmentDomain", "title": "Class: ShipmentItem\nGroup: ShipmentDomain (Double click to view group)", "shape": "box", "font": {"color": "black"}}, {"id": "ControlAction", "label": "ControlAction", "group": "GovernanceDomain", "title": "Class: ControlAction\nGroup: GovernanceDomain (Double click to view group)", "shape": "box", "font": {"color": "black"}}, {"id": "SLA_KPI", "label": "SLA_KPI", "group": "GovernanceDomain", "title": "Class: SLA_KPI\nGroup: GovernanceDomain (Double click to view group)", "shape": "box", "font": {"color": "black"}}];
    var edgesArray = [{"id": "ControlAction_actionForIncident_Incident", "from": "ControlAction", "to": "Incident", "label": "actionForIncident", "arrows": "to", "color": {"inherit": "from"}, "font": {"align": "middle", "size": 10}}, {"id": "ControlAction_actionForShipment_Shipment", "from": "ControlAction", "to": "Shipment", "label": "actionForShipment", "arrows": "to", "color": {"inherit": "from"}, "font": {"align": "middle", "size": 10}}, {"id": "ControlAction_actionResponsibleActor_Actor", "from": "ControlAction", "to": "Actor", "label": "actionResponsibleActor", "arrows": "to", "color": {"inherit": "from"}, "font": {"align": "middle", "size": 10}}, {"id": "Actor_actorBelongsToOrg_Organization", "from": "Actor", "to": "Organization", "label": "actorBelongsToOrg", "arrows": "to", "color": {"inherit": "from"}, "font": {"align": "middle", "size": 10}}, {"id": "IncidentPattern_appliesToLane_Lane", "from": "IncidentPattern", "to": "Lane", "label": "appliesToLane", "arrows": "to", "color": {"inherit": "from"}, "font": {"align": "middle", "size": 10}}, {"id": "IncidentPattern_appliesToPhase_TransportLeg", "from": "IncidentPattern", "to": "TransportLeg", "label": "appliesToPhase", "arrows": "to", "color": {"inherit": "from"}, "font": {"align": "middle", "size": 10}}, {"id": "IncidentPattern_appliesToProduct_Product", "from": "IncidentPattern", "to": "Product", "label": "appliesToProduct", "arrows": "to", "color": {"inherit": "from"}, "font": {"align": "middle", "size": 10}}, {"id": "Shipment_assignedToLane_Lane", "from": "Shipment", "to": "Lane", "label": "assignedToLane", "arrows": "to", "color": {"inherit": "from"}, "font": {"align": "middle", "size": 10}}, {"id": "BatchLot_batchOf_Product", "from": "BatchLot", "to": "Product", "label": "batchOf", "arrows": "to", "color": {"inherit": "from"}, "font": {"align": "middle", "size": 10}}, {"id": "Container_belongsToShipment_Shipment", "from": "Container", "to": "Shipment", "label": "belongsToShipment", "arrows": "to", "color": {"inherit": "from"}, "font": {"align": "middle", "size": 10}}, {"id": "Package_belongsToShipment_Shipment", "from": "Package", "to": "Shipment", "label": "belongsToShipment", "arrows": "to", "color": {"inherit": "from"}, "font": {"align": "middle", "size": 10}}, {"id": "ShipmentItem_belongsToShipment_Shipment", "from": "ShipmentItem", "to": "Shipment", "label": "belongsToShipment", "arrows": "to", "color": {"inherit": "from"}, "font": {"align": "middle", "size": 10}}, {"id": "ContractDocument_contractClientOrg_Organization", "from": "ContractDocument", "to": "Organization", "label": "contractClientOrg", "arrows": "to", "color": {"inherit": "from"}, "font": {"align": "middle", "size": 10}}, {"id": "ContractDocument_contractForLane_Lane", "from": "ContractDocument", "to": "Lane", "label": "contractForLane", "arrows": "to", "color": {"inherit": "from"}, "font": {"align": "middle", "size": 10}}, {"id": "ContractDocument_contractProviderOrg_Organization", "from": "ContractDocument", "to": "Organization", "label": "contractProviderOrg", "arrows": "to", "color": {"inherit": "from"}, "font": {"align": "middle", "size": 10}}, {"id": "Device_deviceAttachedToContainer_Container", "from": "Device", "to": "Container", "label": "deviceAttachedToContainer", "arrows": "to", "color": {"inherit": "from"}, "font": {"align": "middle", "size": 10}}, {"id": "Device_deviceAttachedToPackage_Package", "from": "Device", "to": "Package", "label": "deviceAttachedToPackage", "arrows": "to", "color": {"inherit": "from"}, "font": {"align": "middle", "size": 10}}, {"id": "Device_deviceAttachedToShipment_Shipment", "from": "Device", "to": "Shipment", "label": "deviceAttachedToShipment", "arrows": "to", "color": {"inherit": "from"}, "font": {"align": "middle", "size": 10}}, {"id": "Device_deviceHasSensor_Sensor", "from": "Device", "to": "Sensor", "label": "deviceHasSensor", "arrows": "to", "color": {"inherit": "from"}, "font": {"align": "middle", "size": 10}}, {"id": "DocumentRecord_documentIssuedByOrg_Organization", "from": "DocumentRecord", "to": "Organization", "label": "documentIssuedByOrg", "arrows": "to", "color": {"inherit": "from"}, "font": {"align": "middle", "size": 10}}, {"id": "Event_eventHasSourceReading_SensorReading", "from": "Event", "to": "SensorReading", "label": "eventHasSourceReading", "arrows": "to", "color": {"inherit": "from"}, "font": {"align": "middle", "size": 10}}, {"id": "Event_eventOnPackage_Package", "from": "Event", "to": "Package", "label": "eventOnPackage", "arrows": "to", "color": {"inherit": "from"}, "font": {"align": "middle", "size": 10}}, {"id": "Event_eventOnShipment_Shipment", "from": "Event", "to": "Shipment", "label": "eventOnShipment", "arrows": "to", "color": {"inherit": "from"}, "font": {"align": "middle", "size": 10}}, {"id": "Event_eventOnTransportLeg_TransportLeg", "from": "Event", "to": "TransportLeg", "label": "eventOnTransportLeg", "arrows": "to", "color": {"inherit": "from"}, "font": {"align": "middle", "size": 10}}, {"id": "Event_eventPerformedBy_Actor", "from": "Event", "to": "Actor", "label": "eventPerformedBy", "arrows": "to", "color": {"inherit": "from"}, "font": {"align": "middle", "size": 10}}, {"id": "Shipment_hasContainer_Container", "from": "Shipment", "to": "Container", "label": "hasContainer", "arrows": "to", "color": {"inherit": "from"}, "font": {"align": "middle", "size": 10}}, {"id": "Shipment_hasPackage_Package", "from": "Shipment", "to": "Package", "label": "hasPackage", "arrows": "to", "color": {"inherit": "from"}, "font": {"align": "middle", "size": 10}}, {"id": "Package_hasParentPackage_Package", "from": "Package", "to": "Package", "label": "hasParentPackage", "arrows": "to", "color": {"inherit": "from"}, "font": {"align": "middle", "size": 10}}, {"id": "ShipmentItem_hasProduct_Product", "from": "ShipmentItem", "to": "Product", "label": "hasProduct", "arrows": "to", "color": {"inherit": "from"}, "font": {"align": "middle", "size": 10}}, {"id": "Shipment_hasShipmentItem_ShipmentItem", "from": "Shipment", "to": "ShipmentItem", "label": "hasShipmentItem", "arrows": "to", "color": {"inherit": "from"}, "font": {"align": "middle", "size": 10}}, {"id": "BatchLot_hasStabilityBudget_StabilityBudget", "from": "BatchLot", "to": "StabilityBudget", "label": "hasStabilityBudget", "arrows": "to", "color": {"inherit": "from"}, "font": {"align": "middle", "size": 10}}, {"id": "Product_hasTempProfile_TempProfile", "from": "Product", "to": "TempProfile", "label": "hasTempProfile", "arrows": "to", "color": {"inherit": "from"}, "font": {"align": "middle", "size": 10}}, {"id": "Shipment_hasTransportLeg_TransportLeg", "from": "Shipment", "to": "TransportLeg", "label": "hasTransportLeg", "arrows": "to", "color": {"inherit": "from"}, "font": {"align": "middle", "size": 10}}, {"id": "Incident_incidentAtLocation_Location", "from": "Incident", "to": "Location", "label": "incidentAtLocation", "arrows": "to", "color": {"inherit": "from"}, "font": {"align": "middle", "size": 10}}, {"id": "Incident_incidentFollowsPattern_IncidentPattern", "from": "Incident", "to": "IncidentPattern", "label": "incidentFollowsPattern", "arrows": "to", "color": {"inherit": "from"}, "font": {"align": "middle", "size": 10}}, {"id": "Incident_incidentFromEvent_Event", "from": "Incident", "to": "Event", "label": "incidentFromEvent", "arrows": "to", "color": {"inherit": "from"}, "font": {"align": "middle", "size": 10}}, {"id": "Incident_incidentFromSensorReading_SensorReading", "from": "Incident", "to": "SensorReading", "label": "incidentFromSensorReading", "arrows": "to", "color": {"inherit": "from"}, "font": {"align": "middle", "size": 10}}, {"id": "Incident_incidentOnProduct_Product", "from": "Incident", "to": "Product", "label": "incidentOnProduct", "arrows": "to", "color": {"inherit": "from"}, "font": {"align": "middle", "size": 10}}, {"id": "Incident_incidentOnShipment_Shipment", "from": "Incident", "to": "Shipment", "label": "incidentOnShipment", "arrows": "to", "color": {"inherit": "from"}, "font": {"align": "middle", "size": 10}}, {"id": "Incident_incidentOnShipmentItem_ShipmentItem", "from": "Incident", "to": "ShipmentItem", "label": "incidentOnShipmentItem", "arrows": "to", "color": {"inherit": "from"}, "font": {"align": "middle", "size": 10}}, {"id": "Incident_incidentOnTransportLeg_TransportLeg", "from": "Incident", "to": "TransportLeg", "label": "incidentOnTransportLeg", "arrows": "to", "color": {"inherit": "from"}, "font": {"align": "middle", "size": 10}}, {"id": "SLA_KPI_kpiAppliedToLane_Lane", "from": "SLA_KPI", "to": "Lane", "label": "kpiAppliedToLane", "arrows": "to", "color": {"inherit": "from"}, "font": {"align": "middle", "size": 10}}, {"id": "SLA_KPI_kpiAppliedToOrg_Organization", "from": "SLA_KPI", "to": "Organization", "label": "kpiAppliedToOrg", "arrows": "to", "color": {"inherit": "from"}, "font": {"align": "middle", "size": 10}}, {"id": "SLA_KPI_kpiAppliedToProduct_Product", "from": "SLA_KPI", "to": "Product", "label": "kpiAppliedToProduct", "arrows": "to", "color": {"inherit": "from"}, "font": {"align": "middle", "size": 10}}, {"id": "Lane_laneDestinationLocation_Location", "from": "Lane", "to": "Location", "label": "laneDestinationLocation", "arrows": "to", "color": {"inherit": "from"}, "font": {"align": "middle", "size": 10}}, {"id": "Lane_laneOriginLocation_Location", "from": "Lane", "to": "Location", "label": "laneOriginLocation", "arrows": "to", "color": {"inherit": "from"}, "font": {"align": "middle", "size": 10}}, {"id": "TransportLeg_legDestinationLocation_Location", "from": "TransportLeg", "to": "Location", "label": "legDestinationLocation", "arrows": "to", "color": {"inherit": "from"}, "font": {"align": "middle", "size": 10}}, {"id": "TransportLeg_legHasFlight_Flight", "from": "TransportLeg", "to": "Flight", "label": "legHasFlight", "arrows": "to", "color": {"inherit": "from"}, "font": {"align": "middle", "size": 10}}, {"id": "TransportLeg_legHasTruckMovement_TruckMovement", "from": "TransportLeg", "to": "TruckMovement", "label": "legHasTruckMovement", "arrows": "to", "color": {"inherit": "from"}, "font": {"align": "middle", "size": 10}}, {"id": "TransportLeg_legOperatedByOrg_Organization", "from": "TransportLeg", "to": "Organization", "label": "legOperatedByOrg", "arrows": "to", "color": {"inherit": "from"}, "font": {"align": "middle", "size": 10}}, {"id": "TransportLeg_legOriginLocation_Location", "from": "TransportLeg", "to": "Location", "label": "legOriginLocation", "arrows": "to", "color": {"inherit": "from"}, "font": {"align": "middle", "size": 10}}, {"id": "TruckMovement_movementUsesVehicle_Vehicle", "from": "TruckMovement", "to": "Vehicle", "label": "movementUsesVehicle", "arrows": "to", "color": {"inherit": "from"}, "font": {"align": "middle", "size": 10}}, {"id": "OperationalDocument_operationalDocForLeg_TransportLeg", "from": "OperationalDocument", "to": "TransportLeg", "label": "operationalDocForLeg", "arrows": "to", "color": {"inherit": "from"}, "font": {"align": "middle", "size": 10}}, {"id": "OperationalDocument_operationalDocForShipment_Shipment", "from": "OperationalDocument", "to": "Shipment", "label": "operationalDocForShipment", "arrows": "to", "color": {"inherit": "from"}, "font": {"align": "middle", "size": 10}}, {"id": "OperationalDocument_operationalDocForShipmentItem_ShipmentItem", "from": "OperationalDocument", "to": "ShipmentItem", "label": "operationalDocForShipmentItem", "arrows": "to", "color": {"inherit": "from"}, "font": {"align": "middle", "size": 10}}, {"id": "Organization_organizationHasRole_Role", "from": "Organization", "to": "Role", "label": "organizationHasRole", "arrows": "to", "color": {"inherit": "from"}, "font": {"align": "middle", "size": 10}}, {"id": "RegulationDocument_regulationIssuedByOrg_Organization", "from": "RegulationDocument", "to": "Organization", "label": "regulationIssuedByOrg", "arrows": "to", "color": {"inherit": "from"}, "font": {"align": "middle", "size": 10}}, {"id": "RiskScore_riskForLane_Lane", "from": "RiskScore", "to": "Lane", "label": "riskForLane", "arrows": "to", "color": {"inherit": "from"}, "font": {"align": "middle", "size": 10}}, {"id": "RiskScore_riskForOrganization_Organization", "from": "RiskScore", "to": "Organization", "label": "riskForOrganization", "arrows": "to", "color": {"inherit": "from"}, "font": {"align": "middle", "size": 10}}, {"id": "RiskScore_riskForPackage_Package", "from": "RiskScore", "to": "Package", "label": "riskForPackage", "arrows": "to", "color": {"inherit": "from"}, "font": {"align": "middle", "size": 10}}, {"id": "RiskScore_riskForShipment_Shipment", "from": "RiskScore", "to": "Shipment", "label": "riskForShipment", "arrows": "to", "color": {"inherit": "from"}, "font": {"align": "middle", "size": 10}}, {"id": "RiskScore_riskForTransportLeg_TransportLeg", "from": "RiskScore", "to": "TransportLeg", "label": "riskForTransportLeg", "arrows": "to", "color": {"inherit": "from"}, "font": {"align": "middle", "size": 10}}, {"id": "Role_roleHasActor_Actor", "from": "Role", "to": "Actor", "label": "roleHasActor", "arrows": "to", "color": {"inherit": "from"}, "font": {"align": "middle", "size": 10}}, {"id": "Sensor_sensorHasReading_SensorReading", "from": "Sensor", "to": "SensorReading", "label": "sensorHasReading", "arrows": "to", "color": {"inherit": "from"}, "font": {"align": "middle", "size": 10}}, {"id": "SOPDocument_sopBasedOnRegulation_RegulationDocument", "from": "SOPDocument", "to": "RegulationDocument", "label": "sopBasedOnRegulation", "arrows": "to", "color": {"inherit": "from"}, "font": {"align": "middle", "size": 10}}, {"id": "SOPDocument_sopOwnedByOrg_Organization", "from": "SOPDocument", "to": "Organization", "label": "sopOwnedByOrg", "arrows": "to", "color": {"inherit": "from"}, "font": {"align": "middle", "size": 10}}, {"id": "Vehicle_vehicleOperatedBy_Organization", "from": "Vehicle", "to": "Organization", "label": "vehicleOperatedBy", "arrows": "to", "color": {"inherit": "from"}, "font": {"align": "middle", "size": 10}}];

    var nodes = new vis.DataSet(nodesArray);
    var edges = new vis.DataSet(edgesArray);

    var container = document.getElementById('mynetwork');
    var data = { nodes: nodes, edges: edges };
    
    var options = {
        nodes: {
            borderWidth: 2,
            shadow: true,
            font: { size: 14, face: "Segoe UI" },
            scaling: { min: 10, max: 30 }
        },
        edges: {
            smooth: { type: "dynamic" },
            width: 1,
            color: { opacity: 1 }
        },
        physics: {
            forceAtlas2Based: {
                gravitationalConstant: -50,
                centralGravity: 0.005,
                springLength: 230,
                springConstant: 0.18
            },
            maxVelocity: 146,
            solver: "forceAtlas2Based",
            timestep: 0.35,
            stabilization: { enabled: true, iterations: 1000 }
        },
        interaction: {
            hover: true,
            navigationButtons: true,
            keyboard: true,
            multiselect: true
        }
    };

    var network = new vis.Network(container, data, options);

    function updateByGroups() {
        document.getElementById('nodeSelect').value = "";
        document.getElementById('selectionInfo').style.display = "none";
        document.querySelectorAll('.checkbox-item').forEach(el => el.style.backgroundColor = "transparent");

        var checkboxes = document.querySelectorAll('input[name="groupFilter"]:checked');
        var selectedGroups = Array.from(checkboxes).map(cb => cb.value);

        var allNodeIds = nodes.getIds();
        var allEdgeIds = edges.getIds();
        var updateNodes = [];
        var updateEdges = [];
        var visibleNodeIds = [];

        if (selectedGroups.length === 0) {
            resetAll(false); 
            return;
        }

        allNodeIds.forEach(id => {
            var node = nodes.get(id);
            if (selectedGroups.includes(node.group)) {
                visibleNodeIds.push(id);
                updateNodes.push({ id: id, color: null, font: { color: 'black' }, opacity: 1 });
            } else {
                updateNodes.push({ id: id, color: { background: '#f0f0f0', border: '#e0e0e0' }, font: { color: '#cccccc' }, opacity: 1 });
            }
        });

        allEdgeIds.forEach(id => {
            var edge = edges.get(id);
            if (visibleNodeIds.includes(edge.from) || visibleNodeIds.includes(edge.to)) {
                updateEdges.push({ id: id, color: { inherit: 'from', opacity: 1 }, width: 1 });
            } else {
                updateEdges.push({ id: id, color: { color: '#e0e0e0', opacity: 0.1 }, width: 1 });
            }
        });

        nodes.update(updateNodes);
        edges.update(updateEdges);
    }

    function highlightNode(nodeId) {
        if (!nodeId) return;
        
        var checkboxes = document.querySelectorAll('input[name="groupFilter"]');
        checkboxes.forEach(cb => cb.checked = false);
        document.querySelectorAll('.checkbox-item').forEach(el => el.style.backgroundColor = "transparent");

        var targetNode = nodes.get(nodeId);
        if (targetNode) {
            document.getElementById('selectionInfo').style.display = "block";
            document.getElementById('selectedNodeName').innerText = targetNode.label;
            document.getElementById('selectedNodeGroup').innerText = targetNode.group;
            
            var labelEl = document.getElementById('label-' + targetNode.group);
            if(labelEl) labelEl.style.backgroundColor = "#fff3cd";
        }

        var allNodeIds = nodes.getIds();
        var allEdgeIds = edges.getIds();
        var connectedNodes = network.getConnectedNodes(nodeId);
        connectedNodes.push(nodeId);

        var updateNodes = [];
        var updateEdges = [];

        allNodeIds.forEach(id => {
            if (connectedNodes.includes(id)) {
                updateNodes.push({ id: id, color: null, font: { color: 'black' }, opacity: 1 });
            } else {
                updateNodes.push({ id: id, color: { background: '#f0f0f0', border: '#e0e0e0' }, font: { color: '#cccccc' }, opacity: 1 });
            }
        });

        allEdgeIds.forEach(id => {
            var edge = edges.get(id);
            if (edge.from === nodeId || edge.to === nodeId) {
                updateEdges.push({ id: id, color: { inherit: 'from', opacity: 1 }, width: 3 });
            } else {
                updateEdges.push({ id: id, color: { color: '#e0e0e0', opacity: 0.1 }, width: 1 });
            }
        });

        nodes.update(updateNodes);
        edges.update(updateEdges);
        network.focus(nodeId, { scale: 1.0, animation: { duration: 600, easingFunction: "easeInOutQuad" } });
    }

    network.on("selectNode", function (params) {
        if (params.nodes.length === 1) {
            var nodeId = params.nodes[0];
            document.getElementById('nodeSelect').value = nodeId;
            highlightNode(nodeId);
        }
    });

    network.on("doubleClick", function (params) {
        if (params.nodes.length === 1) {
            var nodeId = params.nodes[0];
            var node = nodes.get(nodeId);
            var group = node.group;

            var checkboxes = document.querySelectorAll('input[name="groupFilter"]');
            checkboxes.forEach(cb => {
                cb.checked = (cb.value === group);
            });
            
            document.getElementById('selectionInfo').style.display = "none";
            updateByGroups();
        }
    });

    function resetAll(resetUI = true) {
        var allNodeIds = nodes.getIds();
        var allEdgeIds = edges.getIds();
        
        nodes.update(allNodeIds.map(id => { return { id: id, color: null, font: { color: 'black' }, opacity: 1 } }));
        edges.update(allEdgeIds.map(id => { return { id: id, color: { inherit: 'from', opacity: 1 }, width: 1 } }));
        
        if (resetUI) {
            document.getElementById('nodeSelect').value = "";
            document.getElementById('selectionInfo').style.display = "none";
            var checkboxes = document.querySelectorAll('input[name="groupFilter"]');
            checkboxes.forEach(cb => cb.checked = false);
            document.querySelectorAll('.checkbox-item').forEach(el => el.style.backgroundColor = "transparent");
            network.fit();
        }
    }
</script>
</body>
</html>
